<section class="content-header">
  <h1>
    Registro de entrada
    <small></small>
  </h1>
  <ol class="breadcrumb">
      <li><a routerLink="/dashboard"><i class="fa fa-dashboard"></i> Dashboard</a></li>
      <li><a routerLink="/entradas">Entradas</a></li>
      <li class="active">Nuevo</li>
    </ol>
</section>
<section class="content">
  <div class="row">
    <div class="col-xs-12 col-md-12">
      <div class="box">
        <div class="box-header with-border">
          <h3 class="box-title">Formulario de Registro</h3>
          <div class="box-tools pull-right">
            <!--
              <button type="button" class="btn btn-sm btn-primary" (click)="addItem()" data-toggle="tooltip" data-placement="top" title="Añadir Articulo">
                <i class="fa fa-cart-plus"></i>
              </button>
            -->
            <button type="button" class="btn btn-sm btn-flat btn-primary" data-toggle="modal" data-target="#modal-busqueda-articulo">
              <i class="fa fa-search"></i>
               Buscar Articulo
            </button>
            </div>
        </div>
        <div class="box-body">
          <form [formGroup]="entradaForm">
            <!-- Detalles generales del ingreso -->
            <div class="row">
              <div class="col-xs-12 col-md-6 col-lg-3">
                <label>Sucursal</label>
                <!--
                <div class="input-group">
                  <input type="text" class="form-control" readonly>
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-primary"><i class="fa fa-search"></i></button>
                  </div>
                </div>
                -->
                <div class="form-group">
                  <select class="form-control">
                    <option value="">Default</option>
                  </select>
                </div>
              </div>
              <div class="col-xs-12 col-md-6 col-lg-3">
                <label>Proveedor</label>
                <div class="input-group">
                  <input type="text" class="form-control" readonly>
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-primary"><i class="fa fa-search"></i></button>
                  </div>
                </div>
              </div>
              <!--
              <div class="col-xs-12 col-md-6 col-lg-3">
                <label>Empleado</label>
                <div class="input-group">
                  <input type="text" class="form-control" readonly>
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-primary"><i class="fa fa-search"></i></button>
                  </div>
                </div>
              </div>
              -->
              <div class="col-xs-12 col-md-6 col-lg-3">
                <div class="form-group">
                  <label>Fecha</label>
                  <input class="form-control" type="date" readonly>
                </div>
              </div>
              <div class="col-xs-12 col-md-6 col-lg-3">
                <label>IVA</label>
                <div class="input-group">
                  <input type="number" value="18" class="form-control" readonly>
                  <span class="input-group-addon">%</span>
                </div>
              </div>
            </div>
            <!-- Lista de productos del ingreso -->
            <table class="table table-bordered table-responsive">
              <thead>
                <tr>
                  <th>Articulo</th>
                  <th>Serie</th>
                  <th>Codigo</th>
                  <th>Cant. Ingreso</th>
                  <th>P. Compra</th>
                  <th>P.V. Publico</th>
                  <th>P.V. Distribuidor</th>
                  <th>Opciones</th>
                </tr>
              </thead>
              <tbody *ngIf="articulos.length > 0">
                <tr *ngFor="let articulo of articulos; let i = index;">
                  <td>{{articulo.nombre}}</td>
                  <td><input type="text" class="form-control" [value]="articulo.serie"></td>
                  <td><input type="text" class="form-control" [value]="articulo.codigo"></td>
                  <td><input type="text" class="form-control" [value]="articulo.stock_ingreso"></td>
                  <td><input type="text" class="form-control" [value]="articulo.precio_compra"></td>
                  <td><input type="text" class="form-control" [value]="articulo.precio_venta_publico"></td>
                  <td><input type="text" class="form-control" [value]="articulo.precio_venta_distribuidor"></td>
                  <td>
                    <button class="btn btn-danger" (click)="removeItem(i)"><i class="fa fa-trash"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>
            <!--
            <div class="row">
              <div formArrayName="items" *ngFor="let item of entradaForm.get('items').controls; let i = index;">
                <div [formGroupName]="i" class="form-group" style="padding-bottom: 30px;">
                  <div class="col-xs-12 col-md-6 col-lg-2">
                    <input type="text" class="form-control" placeholder="Producto" formControlName="producto">
                  </div>
                  <div class="col-xs-12 col-md-6 col-lg-1">
                    <input type="text" class="form-control" placeholder="Serie" formControlName="serie">
                  </div>
                  <div class="col-xs-12 col-md-6 col-lg-2">
                    <input type="text" class="form-control" placeholder="Codigo" formControlName="codigo">
                  </div>
                  <div class="col-xs-12 col-md-6 col-lg-1">
                    <input type="number" class="form-control" placeholder="N. Ingreso" formControlName="stock_ingreso">
                  </div>
                  <div class="col-xs-12 col-md-6 col-lg-1">
                    <input type="text" class="form-control" placeholder="Precio" formControlName="precio_compra">
                  </div>
                  <div class="col-xs-12 col-md-6 col-lg-2">
                    <input type="text" class="form-control" placeholder="P.C.P" formControlName="precio_venta_publico">
                  </div>  
                  <div class="col-xs-12 col-md-6 col-lg-2">
                    <input type="text" class="form-control" placeholder="P.C.D" formControlName="precio_venta_distribuidor">
                  </div>
                  <div class="col-xs-12 col-md-6 col-lg-1">
                    <button class="btn btn-danger" (click)="removeItem(i)">
                      <i class="fa fa-trash"></i>
                    </button>
                  </div>                
                </div>
              </div>
            </div>
          -->
          </form>
        </div>
        <div class="box-footer clearfix">
          <button class="btn btn-danger pull-left">
            Cancelar
          </button>
          <button class="btn btn-success pull-right">
            Registrar
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Modal Busqueda de producto -->
  <!-- Modal Registro -->
  <div class="modal fade" id="modal-busqueda-articulo">
    <div class="modal-dialog  modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <div class="box-tools pull-left">
            <div class="input-group input-group-sm">
            </div>
          </div>
          <div class="box-tools pull-right">
            <div class="row" style="display: flex; padding-right: 15px;">
              <div class="col input-group input-group-sm" style="padding-left: 5px; padding-right: 5px;">
                <input type="text" [(ngModel)]="query" (input)="getItems()" class="form-control" placeholder="Buscar">
              </div>
              <div class="col input-group input-group-sm" style="padding-left: 5px; padding-right: 5px;">
                <select class="form-control" [(ngModel)]="order_by" (change)="getItems()">
                  <option value="">Ordenar por (N/A)</option>
                  <option value="nombre">Nombre</option>
                  <option value="categoria">Categoria</option>
                </select>
              </div>
              <div class="col input-group input-group-sm" style="padding-left: 5px; padding-right: 5px;">
                <select class="form-control" [(ngModel)]="per_page" (change)="getItems()">
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <div class="table-responsive no-padding" *ngIf="!isLoading">
            <table class="table table-hover" style="min-height: 450px !important;">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Categoria</th>
                  <th>Descripción</th>
                  <th>Opciones</th>
                </tr>
              </thead>
              <tbody style="overflow: auto;">
                <tr *ngFor="let resultado of resultados">
                  <td>{{resultado.nombre}}</td>
                  <td>{{resultado.catNombre}}</td>
                  <td>{{resultado.descripcion}}</td>
                  <td>
                    <button class="btn btn-success btn-sm" (click)="addItem(resultado)">
                      <i class="fa fa-plus"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
            <ngb-pagination 
              class="pagination pagination-sm no-margin pull-right"
              [collectionSize]="total_results" 
              [(page)]="page" 
              [maxSize]="5" 
              [rotate]="true" 
              [pageSize]="per_page"
              [ellipses]="false" 
              [boundaryLinks]="true"
              size="sm"
              (pageChange)="getItems()">
            </ngb-pagination>
          </div>
          <div *ngIf="isLoading" class="no-data-available">
            <h4>Procesando...</h4>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger pull-left" data-dismiss="modal">Salir</button>
          <button type="button" class="btn btn-success">Registrar</button>
        </div>     
      </div>
    </div>
  </div>